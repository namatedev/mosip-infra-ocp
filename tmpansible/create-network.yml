---
- hosts: localhost
  tasks:
  
    # Define a new network
    - name: Define network br_nat
    virt_net:
      command: define
      name: br_nat
      xml: '{{ lookup("template", "network/bridge.xml.j2") }}'

    # Ensure that a network is active (needs to be defined and built first)
    - name: Active network br_nat
      virt_net:
        state: active
        name: br_nat

# Add a new host in the dhcp pool
# - community.libvirt.virt_net:
#     name: br_nat
#     command: modify
#     xml: "<host mac='FC:C2:33:00:6c:3c' name='my_vm' ip='192.168.122.30'/>"